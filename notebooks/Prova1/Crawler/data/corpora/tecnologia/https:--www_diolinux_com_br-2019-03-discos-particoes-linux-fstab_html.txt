ter√ßa-feira, 5 de mar√ßo de 2019Quando eu estava aprendendo Linux, lembro de ter lido em algum lugar algo que dizia: "No Linux tudo s√£o arquivos". E querendo ou n√£o, de fato, toda a configura√ß√£o do sistema, de forma geral, √© feita atrav√©s de "simples" arquivos de textos, configurados de forma a fazer tudo o que voc√™ v√™ na sua tela funciona como se deve. Um desses arquivos √© o FSTAB (File Systems Table).Mesmo que voc√™ nunca sequer tenha pensando nisso, a sua distribui√ß√£o Linux faz, toda a vez que voc√™ liga o seu computador e d√° boot no sistema operacional, a montagem das parti√ß√µes do seu disco, do seu SWAP e de onde fica cada coisa. Esse √© um processo autom√°tico que ocorre baseado nas informa√ß√µes contidas em um arquivo que fica no diret√≥rio /etc/fstab.Configurando FSTABO que faz com que muitas pessoas tenham receio do FSTAB √© que ele √© um arquivo realmente n√£o muito claro, especialmente se comparado com outros que existem por a√≠, que possuem v√°rias linhas coment√°rios informando como trabalhar com as informa√ß√µes contidas neles mesmos.Meu conselho mais b√°sico √©: Encare o FSTAB como o que ele √©: uma tabela. O nome TAB (de Table) n√£o est√° ali √† toa. Ao abri-lo, para facilitar, tente visualizar as colunas e linhas, isso vai ajudar bastante.Voc√™ pode abrir ele com qualquer editor de textos que quiser, como o gedit, xed, pluma, entre outros, mas que tal brincarmos no terminal um pouco? üòÑVoc·∫Ω pode fazer uma leitura r√°pida do que est√° contido no seu FSTAB com esse comando:cat /etc/fstabIsso deve te trazer informa√ß√µes semelhantes a essa:O FSTAB √© respons√°vel pela montagem do seu pr√≥prio sistema, por isso, ele √© um arquivo bem "sens√≠vel", caso voc√™ esteja apenas estudando, √© recomendo faz√™-lo em uma m√°quina virtual.Outra possibilidade √© fazer backup do arquivo antes de come√ßar a edit√°-lo, por exemplo:sudo cp /etc/fstab /etc/fstab-bkpSe precisar usar esse arquivo de backup, coloque ele de volta no lugar assim:sudo cp /etc/fstab-bkp /etc/fstabVamos usar um editor de textos simples e dispon√≠vel para todas as distros Linux para editar o FSTAB, o Nano. Para abrir o arquivo com propriedades adequadas para modifica√ß√£o, use:sudo nano /etc/fstabOu rode o comando como Root, caso a sua distro n√£o possua o seu usu√°rio dentro do sudoers.Entendendo o FSTABEsse √© o ponto primordial. Como j√° informado, o FSTAB nada mais √© do que uma tabela (mesmo que n√£o tenha muito essa cara inicialmente), cada coluna suporta algumas informa√ß√µes diferentes. S√£o elas:Coloquei efetivamente em uma tabela esse exemplo para ficar um pouco mais claro, mas vale uma observa√ß√£o, muitas vezes no lugar de "/dev/sda1" do exemplo, pode haver a UUID do dispositivo, de uma forma semelhante a essa: UUID=04b60adc-ccc2-406e-9cbb-fb80f9c4e5fb. No fim, √© isso que bagun√ßa um pouco as coisas, mas voc√™ pode montar os seus discos e parti√ß√µes apenas sabendo o nome deles, usando o comando:lsblkRepare os nomes abaixo da columa "NAME" e ao lado voc√™ consegue ver o tamanho e o tipo, se √© "apenas leitura" (RO) e se j√° est√° montado em algum lugar em "MOUNTPOINT".Antes de processeguirmos, √© importante que voc√™ conhe√ßa alguma das op√ß√µes envolvendo as colunas do FSTAB:File System:Pode conter a UUID do dispositivo ou o endere√ßo dele. Dispositivos como parti√ß√µes e discos ficam sempre em /dev no mundo Linux, ent√£o uma parti√ß√£o (como esta de 1,4T na imagem acima) poderia ser encontrada em /dev/sdc1.Para verificar o UUID de uma parti√ß√£o para usar no lugar do endere√ßo, use o comando:blkidMount Point: √â simplesmente o local onde a parti√ß√£o ou disco est√° montado. Ela pode apontar para qualquer lugar do sistema √† partir da raiz (/). Geralmente os dispositivos montados automaticamente pelo sistema, como pen drives, HDs Externos, etc. s√£o montados em /media, por√©m, quando isso √© feito manualmente √© comum usar o diret√≥rio /mnt, mas realmente, voc√™ pode montar em qualquer lugar que quiser.Type:Nessa columa voc√™ deve colocar o tipo do sistema de arquivos de cada disco, voc√™ pode ver qual o sistema de arquivos a sua parti√ß√£o usa com o comando:sudo file -s /dev/sdc1Observe que a parte sublinhada deve ser trocada pelo caminho da unidade que voc√™ quer observar, para saber qual o nome das unidades √© poss√≠vel usar o comando que mostramos antes, o lsblk. Esse comando "file -s" ainda pode ser √∫til para voc√™ descobrir a UUID do disco, al√©m de permitir que voc√™ veja em qual sistema de arquivos o seu disco est√° formatado.Alguns comuns seriam:- ext4- swap- ntfs-3g- vfat- btrfs- ntfs- autoSe por algum motivo voc√™ n√£o sabe ou n√£o conseguiu descobrir qual o filesystem do disco, voc√™ pode tentar usar a op√ß√£o "auto", que tenta adivinhar o formato na hora da montagem.Options: Nessa coluna do FSTAB voc√™ vai adicionar as op√ß√µes de montagem que existem. Existem diversas op√ß√µes diferentes, eu vou listar algumas das mais comuns aqui. V√°rias op√ß√µes podem ser usadas em uma mesma linha, bastando adicionar uma virgula apenas entre cada uma, sem a necessidade de espa√ßo.- auto/noauto: Essa op√ß√£o permite que o dispositivo seja montado automaticamente durante o boot do sistema, sendo que "auto" √© a op√ß√£o padr√£o, se voc√™ n√£o quer que o disco seja montado durante o boot, √© necess√°rio dizer explicitamente que voc√™ n√£o quer isso colocando a op√ß√£o "noauto".- dev/nodev: Indica se o disco ou parti√ß√£o deve ou n√£o ser considerado um dispositivo que cont√©m um sistema de arquivos "especial". Geralmente a op√ß√£o "nodev" √© usada em sistemas que tem acesso p√∫blico e tal op√ß√£o impede que qualquer usu√°rio possa fazer certas altera√ß√µes, como criar um "device file".- exec/noexec: Como voc√™ pode ver, as op√ß√µes at√© que s√£o simples de ententer, uma permite algo, a outra nega. Nesse caso voc√™ pode permitir ou negar que os bin√°rios nessa parti√ß√£o ou disco sejam executados.- rw/ro: Se voc√™ associar aos seus significados fica f√°cil de ententer, rw (read and write/leitura e escrita) e ro (read only/apenas leitura).- user/users/nouser: Nessa sess√£o podemos ter tr√™s op√ß√µes. A op√ß√£o "user" permite que qualquer usu√°rio monte esse sistema de arquivos, o que automaticamente ativa outras fun√ß√µes como noexec, nosuid e nodev, a menos que voc√™ informe o contr√°rio. Se a op√ß√£o "nouser" for especificada, apenas o root poder√° montar esse sistema de arquivos, j√° se a op√ß√£o "users" for a selecionada, qualquer usu√°rio dentro do grupo users ser√° capaz de montar o dispositivo.- defaults: Como o nome sugere, essa op√ß√£o usa os padr√µes do Linux/da distro. A configura√ß√£o padr√£o √© definida conforme o sistema de arquivo. Geralmente isso quer dizer que as op√ß√µes ser√£o equivalentes a rw,suid,dev,exec,auto,nouser,async.- owner: Permite que apenas o dono do dispositivo o monte, ou seja, quem criou o sistema de arquivos.Existem muitas outras op√ß√µes dispon√≠veis, e uma leitura bacana para se fazer sobre isso pode ser nas p√°ginas:Dump:Nessa coluna voc√™ pode indicar atrav√©s de um (1) ou zero (0) se a unidade que est√° sendo montada deve receber um backup do programa dump. Colocar Zero indica que esse sistema de arquivos nunca ser√° "backupeado" automaticamente dessa forma, em alguns casos, √© preciso ver se o dump est√° instalado na distro.Pass:O n√∫mero que for adicionado nessa linha indicada a ordem em que o fsck vai fazer a checagem do disco por erros na hora do boot.Com isso finalizamos a explica√ß√£o de cada uma das op√ß√µes mais populares para a montagem de uma parti√ß√£o. Para voc√™ entender um pouco melhor, vamos para um caso pr√°tico.Montando um disco e adicionando no FSTABVoltemos para a parte onde eu mostrei o comando "lsblk". Digamos que eu queira montar a minha parti√ß√£o "sdc1" de 1,4TB atrav√©s do FSTAB na inicializa√ß√£o do meu sistema.Primeiro vamos criar o ambiente ideal para fazer montagem. Eu vou fazer a minha montagem dentro de /mnt, ent√£o vou criar uma pasta dentro desse direit√≥rio para montar o meu disco, assim fica tudo organizado. Esse disco de 1,4TB √© um HD de backup, ent√£o vou chamar a pasta de "dados".sudo mkdir /mnt/dadosO comando acima cria uma pasta, ou diret√≥rio, dentro da minha pasta /mnt com o nome "dados", ent√£o agora vamos indicar esse ponto de montagem no fstab, vamos edit√°-lo usando o editor nano.sudo nano /etc/fstabSer√° que voc√™ consegue ver a ideia da tabela em a√ß√£o agora? :)No nano voc√™ deve navegar usando as setas do seu teclado at√© a √∫ltima linha e digitar os dados da parti√ß√£o que voc√™ quer montar, no meu caso:/dev/sdc1 /mnt/dados ext4 defauts 0 0Indicando, em ordem, o disco que eu quero montar (/dev/sdc1), onde eu quero que seja montado (/mnt/dados), qual o sistema de arquivos do disco (ext4), configura√ß√µes padr√µes (defaults) e configuran√ß√£o de dump e pass setadas para zero (0).Voc√™ pode tamb√©m fazer coment√°rios (como eu fiz na imagem acima) adicionar um # e depois escrever o que quiser. Tudo o que ficar nessa linha ser√° ignorado na leitura do fstab pelo sistema, esses coment√°rios servem apenas para intera√ß√£o humana e melhor compreen√ß√£o.No nano voc√™ geralmente usa a tecla Ctrl (Control) combinada com alguma outra tecla para executar uma fun√ß√£o, por√©m, voc√™ pode, aqui, para sair e salvar, pressionar "Ctrl+X", o editor vai te perguntar se voc√™ quer salvar o arquivo, pressione o "S" (de SIM) e sobrescreva o seu fstab dando "enter".Dica: Tome cuidado para n√£o alterar o nome do arquivo, ele deve continuar se chamando fstab!Muito bem, de fato, agora se voc√™ reiniciasse o seu computador a sua parti√ß√£o ou disco seria montada no diret√≥rio indicado, por√©m, voc√™ pode fazer isso manualmente para montar o dispositivo agora mesmo usando esse comando:sudo mount -O /dev/sdc1 /mnt/dadosLembrando que "/dev/sdc1" deve ser alterado para a nomenclatura que corresponde ao seu disco e "/mnt/dados" deve ser alterado pelo caminho e nome da pasta onde voc√™ quer fazer a montagem.Com isso voc√™ j√° tem todas as informa√ß√µes excenciais para fazer a montagem das parti√ß√µes do seu servidor, ou at√© mesmo na sua distro de desktop, se voc√™ for "mais raiz". üòÄFazendo montagens para interface gr√°ficaTem uma galera que fica um pouco presa ao "old way" de fazer as coisas, e esse nem sempre √© jeito √© o mais f√°cil. Claro, se √© um servidor, se voc√™ √© um profissional ou um estudante de Linux √© outra hist√≥ria, mas se voc√™ tem uma interface na sua frente e s√≥ quer montar o seu disco e nada mais, nada impede que voc√™ use uma interface.Existe um utilit√°rio do GNOME que vem com a maior parte das distros chamado "GNOME Disks", o nome do pacote geralmente √© "gnome-disk-utility" ou "gnome-disks" e voc√™ o encontra no reposit√≥rio de qualquer distro. Quando o sistema est√° traduzido para Portugu√™s, geralmente voc√™ o o encontra no menu do sistema procurando por "Discos".Ele √© um software muito legal, tem v√°rios recursos para voc√™ se informar sobre os os seus discos. Voc√™ pode ver os desenhos das parti√ß√µes, tamanhos, formatos, sistemas de arquivos, tipos, fazer benchmarks, fazer testes de sa√∫de dos discos, entre muitas outras coisas. Realmente fant√°stico.Umas das funcionalidades dele √© controlar a montagem de discos, fazendo com que tudo que fizemos "na unha" antes possa ser feito atrav√©s de uma simples, mas poderosa, interface.Para seguir o mesmo exemplo, digamos que eu queira montar o meu HD de 1,4 (1,5) TB aumaticamente com o sistema, basta eu clicar no disco na esquerda, depois voc√™ pode clicar no √≠cone da engrenagem e ir at√© "op√ß√µes de montagem", onde voc√™ vai encontrar v√°rias op√ß√µes de configura√ß√µes, muitas delas relacionadas ao que aprendemos ao longo do post.√â interessante ver a evolu√ß√£o do Linux nesse sentido, o n√≠vel personaliza√ß√£o para fazer o que voc√™ bem entender com o sistema configurando apenas arquivos √© sensacional, tamb√©m √© curioso pensar que h√° algumas d√©cadas a √∫nica forma de fazer certas coisas era via terminal e esses arquivos de configura√ß√£o. Atualmente tudo pode ser mais simples e bonito, mas o poder da linha de comando continua l√° para quem quiser tom√°-lo.