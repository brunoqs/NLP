segunda-feira, 17 de dezembro de 2018Quem é recém chegado ao mundo Linux e utiliza NVIDIA pode ficar em dúvida sobre qual driver usar no seu equipamento, se o proprietário ou o de código aberto (chamado de Nouveau), e muitos provavelmente em um primeiro contato utilizam o nouveau, por ser o que vem por padrão no Kernel, tendo assim uma experiência nada agradávelAté descobrirem como instalar o driver proprietário de forma correta (que é mamão com açúcar) podem ficar chateados e até “com raiva” do sistema, assim não voltando mais a utilizar ele por causa de pequenos detalhes.Falando em instalar drivers da NVIDIA de forma fácil, recentemente fizemos um post explicando melhor como fazer isso, vale a pena conferir. =)De uns tempos para cá a solução open source para NVIDIA não vinha trazendo resultados satisfatórios, com perda de rendimento em games, renderização de vídeos e em alguns casos nem subindo o sistema operacional, como acontece nos notebooks com placas híbridas.Também fizemos duas matérias falando sobre o sistema híbrido, uma comentando as novidades que virão à partir do Xorg 1.20 e o outra sobre como instalar o driver Linux (Ubuntu e Mint).AMD e IntelQuem utiliza AMD e Intel geralmente não se aborrece com esses “perrengues”, visto que os drivers de vídeo dessas empresas vêm embutidos diretamente no kernel e se precisar de uma versão mais nova, basta instalar o MESA Driver mais recente e receber os últimos updates. Também fizemos um artigo de como receber as versões do MESA.Dito isso, sempre se especulou o quanto o driver open source “perdia” em relação ao proprietário, visto que a NVIDIA não facilita a vida dos desenvolvedores do Nouveau, liberando por exemplo o firmware com suporte ao PMU (Power Management Unit ou Unidade de Gerenciamento de Energia) entre outras features.Testando o driver Open Source da NvidiaPara tirar essa dúvida a limpo, o pessoal do site Phoronix, resolveu testar algumas placas de vídeo, primeiro com o driver proprietário da NVIDIA na versão 415 e depois com o Nouveau utilizando o Kernel Linux 4.19 e com o MESA 19.0-devel.No caso do nouveau, eles precisaram fazer um re-clocked 0f em algumas placas para que o teste pudesse ser feito. As placas utilizadas foram: NVIDIA GeForce GTX 680 2GB (1066/3004MHz), NVIDIA GTX 750 Ti 2GB (1019/2700MHz), NVIDIA GTX 780 Ti 3GB (875/3500MHz), NVIDIA GTX 980 4GB (1126/3505MHz) e a NVIDIA GTX 1080 8GB (1607/5005MHz). O teste foi feito no Ubuntu 18.04.No driver proprietário da NVIDIA, tinha o VULKAN 1.1 + OpenGL 4.6, enquanto que no nouveau só tinha o OpenGL 4.3.Os jogos utilizados no teste foi limitado para aqueles que tinham suporte para o OpenGL, visto que o nouveau ainda não tem suporte para VULKAN.O primeiro jogo a ser testado foi o BioShock Infinite, que quando utilizado as GPUs GTX 680, GTX 780Ti e GTX 750 Ti (tecnologias Kepler e Maxwell1 respectivamente) a média de fps ficava na casa dos 60 fps utilizando o nouveau, mas quando ia para às GTX 980 e GTX 1080 não passavam dos 20 fps (tecnologias Maxwell e Pascal respectivamente).Já quando foi utilizado o driver proprietário nas GPUs, o mínimo registrado foi de 100 fps com a GTX 750 Ti.Outro jogo que foi utilizado, foi o popular moba Dota 2. Quando utilizado nouveau nas GPUs mais “antigas” se conseguiu uma média de 30 fps, já nas GPUs mais novas não passou dos 12 fps de média, utilizando o driver proprietário, foi mais que o dobro de ganho de FPS nas GPUs. A diferença fica visível nas GPUs mais novas.Já nos jogos de código aberto, a situação é um pouco mais confortável para o nouveau, os jogos que ele se saiu bem foram: ET:Legacy v2.75; Xonotic v0.8.2 e The Tesseract v2014-05-12. Nesses games o driver open source ficou “colado”com o driver proprietário, conforme você pode ver nas imagens abaixo, mas ainda assim perdendo.Com esses testes, podemos tirar algumas ideias sobre o driver open source, o nouveau. Caso você tenha uma GPU um pouco mais antiga, como as das séries 600 e 700, o desempenho em jogos fica no razoável, ainda que você não tenha suporte ao Vulkan, o que é uma grande perda para jogos mais recentes e para os que rodam via Proton e DXVK. Caso você tenha GPUs mais recentes, das séries 900 e 1000, o desempenho fica perto do injogável.Enquanto a NVIDIA não trabalhar junto com o pessoal do Nouveau, infelizmente ele ficará preso a GPUs antigas e tecnologias básicas, uma triste realidade. Ao menos a empresa oferece um driver proprietário que funciona corretamente e entrega um bom desempenho.